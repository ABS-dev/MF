<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Quick Start when calculating MF from Hierarchical Data • MF</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quick Start when calculating MF from Hierarchical Data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MF</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.4.11</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/QuickStartHierData.html">Quick Start when calculating MF from Hierarchical Data</a></li>
    <li><a class="dropdown-item" href="../articles/MFHierarchicalData.html">Algorithms for calculating MF from hierarchical data</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ABS-dev/MF" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="QuickStartHierData_files/kePrint-0.0.1/kePrint.js"></script><link href="QuickStartHierData_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Quick Start when calculating MF from Hierarchical Data</h1>
                        <h4 data-toc-skip class="author">Center for
Veterinary Biologics - Statistics Section</h4>
            
            <h4 data-toc-skip class="date">August 2019</h4>
      

      <div class="d-none name"><code>QuickStartHierData.rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 class="unnumbered" id="introduction">INTRODUCTION<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This document is intended to supplement function help pages and guide
users through the steps of applying functions of the <code>MF</code>
package to the evaluation of mitigated fraction when data is arranged in
a nested hierarchical structure, first implemented in version 4.3.5.
Details of the algorithm are covered in a separate vignette titled <a href="https://github.com/ABS-dev/MF/blob/master/inst/doc/MFHierarchicalData.pdf" class="external-link">Algorithms
for calculating MF from hierarchical data</a>. When calculating MF for
clustered but not hierarchical data, refer to help pages for functions
<code>MFClus</code> and <code>MFClusBoot</code>. For convenience, all
help pages can also be accessed via the <a href="https://github.com/ABS-dev/MF/blob/master/inst/doc/MF-manual.pdf" class="external-link">MF
Manual</a>.</p>
<div class="section level3">
<h3 class="unnumbered" id="data-assumptions--nested-hierarchical-structure-">Data assumptions. Nested Hierarchical
structure.<a class="anchor" aria-label="anchor" href="#data-assumptions--nested-hierarchical-structure-"></a>
</h3>
<p>Examples in this document expect input data to be structured in a
<em>nested hierarchical tree</em>, as shown in Table 1. If there is only
one grouping variable or the experimental design is crossed, it is not
appropriate to use this guide as written.</p>
<p>A nested design assumes that the factor level of one variable
co-occurs with that of another variable. For example, Pen D exists only
within Room Z.</p>
<table class="table table table-bordered" style="font-size: 8px; width: auto !important; margin-left: auto; margin-right: auto;">
<caption style="font-size: initial !important;">
Nested hierarchical data structure.
</caption>
<thead><tr>
<th style="text-align:center;">
room
</th>
<th style="text-align:center;">
pen
</th>
<th style="text-align:center;">
litter
</th>
<th style="text-align:center;">
tx
</th>
<th style="text-align:center;">
lung
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="24">
Room W
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="8">
Pen A
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="4">
Litter 11
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
vac
</td>
<td style="text-align:center;">
5.63
</td>
</tr>
<tr>
<td style="text-align:center;">
4.62
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
con
</td>
<td style="text-align:center;">
9.20
</td>
</tr>
<tr>
<td style="text-align:center;">
7.28
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="4">
Litter 12
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
vac
</td>
<td style="text-align:center;">
3.76
</td>
</tr>
<tr>
<td style="text-align:center;">
3.86
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
con
</td>
<td style="text-align:center;">
6.31
</td>
</tr>
<tr>
<td style="text-align:center;">
3.52
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="8">
Pen B
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="4">
Litter 13
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
vac
</td>
<td style="text-align:center;">
4.36
</td>
</tr>
<tr>
<td style="text-align:center;">
6.10
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
con
</td>
<td style="text-align:center;">
7.87
</td>
</tr>
<tr>
<td style="text-align:center;">
8.34
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="4">
Litter 14
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
vac
</td>
<td style="text-align:center;">
5.39
</td>
</tr>
<tr>
<td style="text-align:center;">
5.80
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
con
</td>
<td style="text-align:center;">
8.28
</td>
</tr>
<tr>
<td style="text-align:center;">
7.95
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="8">
Pen C
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="4">
Litter 15
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
vac
</td>
<td style="text-align:center;">
4.86
</td>
</tr>
<tr>
<td style="text-align:center;">
5.66
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
con
</td>
<td style="text-align:center;">
7.66
</td>
</tr>
<tr>
<td style="text-align:center;">
8.52
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="4">
Litter 16
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
vac
</td>
<td style="text-align:center;">
4.17
</td>
</tr>
<tr>
<td style="text-align:center;">
4.84
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
con
</td>
<td style="text-align:center;">
5.82
</td>
</tr>
<tr>
<td style="text-align:center;">
7.72
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="23">
Room Z
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="8">
Pen D
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="4">
Litter 17
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
vac
</td>
<td style="text-align:center;">
3.60
</td>
</tr>
<tr>
<td style="text-align:center;">
4.92
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
con
</td>
<td style="text-align:center;">
5.22
</td>
</tr>
<tr>
<td style="text-align:center;">
5.93
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="4">
Litter 18
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
vac
</td>
<td style="text-align:center;">
7.62
</td>
</tr>
<tr>
<td style="text-align:center;">
5.04
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
con
</td>
<td style="text-align:center;">
8.62
</td>
</tr>
<tr>
<td style="text-align:center;">
6.27
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="8">
Pen E
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="4">
Litter 19
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
vac
</td>
<td style="text-align:center;">
3.79
</td>
</tr>
<tr>
<td style="text-align:center;">
5.38
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
con
</td>
<td style="text-align:center;">
9.45
</td>
</tr>
<tr>
<td style="text-align:center;">
6.51
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="4">
Litter 20
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
vac
</td>
<td style="text-align:center;">
5.30
</td>
</tr>
<tr>
<td style="text-align:center;">
4.42
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
con
</td>
<td style="text-align:center;">
7.21
</td>
</tr>
<tr>
<td style="text-align:center;">
6.35
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="7">
Pen F
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="4">
Litter 21
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
vac
</td>
<td style="text-align:center;">
4.69
</td>
</tr>
<tr>
<td style="text-align:center;">
6.04
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
con
</td>
<td style="text-align:center;">
6.64
</td>
</tr>
<tr>
<td style="text-align:center;">
7.00
</td>
</tr>
<tr>
<td style="text-align:center;vertical-align: middle !important;" rowspan="3">
Litter 22
</td>
<td style="text-align:center;vertical-align: middle !important;" rowspan="2">
vac
</td>
<td style="text-align:center;">
4.90
</td>
</tr>
<tr>
<td style="text-align:center;">
5.37
</td>
</tr>
<tr>
<td style="text-align:center;">
con
</td>
<td style="text-align:center;">
6.77
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 class="unnumbered" id="mitigated-fraction--bootstrapped-and-calculated-">Mitigated Fraction. Bootstrapped and
Calculated.<a class="anchor" aria-label="anchor" href="#mitigated-fraction--bootstrapped-and-calculated-"></a>
</h3>
<p>Users have the option of simply calculating the mitigated fraction or
simultaneously bootstrapping the mitigated fraction (including
confidence interval) <em>and</em> calculating the mitigated fraction.
Examples of both options are shown in this document.</p>
</div>
<div class="section level3">
<h3 class="unnumbered" id="technical-requirements-">Technical requirements.<a class="anchor" aria-label="anchor" href="#technical-requirements-"></a>
</h3>
<p>Examples in this manual were created using MF version 4.4.11, R
version 4.5.0 (2025-04-11 ucrt) on Windows. CVB has not tested code
usage on other systems.</p>
<p>The package can be found online at: <a href="https://github.com/ABS-dev/MF/blob/master/README.md" class="external-link uri">https://github.com/ABS-dev/MF/blob/master/README.md</a>,
including installation instructions. It is expected that users have
passing familiarity with R code and usage, as CVB does not have
resources to address training or IT issues that may occur at external
organizations.</p>
<p>Bug reports can be submitted online at: <a href="https://github.com/ABS-dev/MF/issues" class="external-link uri">https://github.com/ABS-dev/MF/issues</a>. To expedite
resolution, please include a minimal working example and refrain from
using confidential data. Incomplete issues may be closed without further
investigation. Do not include confidential data as issue tracking is
visible to all.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="calculated-mf">CALCULATED MF<a class="anchor" aria-label="anchor" href="#calculated-mf"></a>
</h2>
<div class="section level3">
<h3 class="unnumbered" id="general-use-">General use.<a class="anchor" aria-label="anchor" href="#general-use-"></a>
</h3>
<p>To calculate mitigated fraction directly from data without
bootstrapping, use the function <code>MFClusHier</code>. This function
requires four inputs:</p>
<ul>
<li>
<code>formula</code>: The formula in form <code>y ~ x + a/b/c</code>
where <code>y</code> is a continuous response, <code>x</code> is a
factor with two levels of treatment, and <code>a/b/c</code> are grouping
variables. Nesting is assumed to be in order, left to right, highest to
lowest. So a single level of “a” will contain multiple levels of “b” and
a single level of “b” will contain multiple levels of “c”.</li>
<li>
<code>data</code>: The data table (<code>data.frame</code> or
<code>tibble</code>) with variables as identified in formula. If there
are extra variables, they will be ignored.</li>
<li>
<code>compare</code>: Treatment groups, a text vector of length two.
The first position [1] is treated as the control or reference group to
which members of the second position [2] are compared.</li>
<li>
<code>which.factor</code>: One or more variable(s) of interest. This
can be any of the grouping variables from the data set. If “All” is
specified, a summary MF will be calculated for the whole tree.</li>
</ul>
<p>Refer to the <code>MFClusHier</code> help page
(<code><a href="../reference/MFClusHier.html">?MFClusHier</a></code>) for extended usage details.</p>
</div>
<div class="section level3">
<h3 class="unnumbered" id="looking-at-mf-for-levels-of-a-variable-">Looking at MF for levels of a variable.<a class="anchor" aria-label="anchor" href="#looking-at-mf-for-levels-of-a-variable-"></a>
</h3>
<p>The <code>which.factor</code> argument allows users the option of
selecting if mitigated fraction should be calculated for levels of a
particular variable. In the data from Table 1, it may be of interest to
calculate the mitigated fraction for each level of variable “room”. It
is possible to consider levels from multiple variables simultaneously,
and the designator <code>All</code> can be used to evaluate for the
entire tree, without breaking out by any variable. Evaluating the value
of mitigated fraction for the entire tree is the default behavior,
should the user not specify anything to the <code>which.factor</code>
argument.</p>
</div>
<div class="section level3">
<h3 class="unnumbered" id="common-coding-examples-">Common coding examples.<a class="anchor" aria-label="anchor" href="#common-coding-examples-"></a>
</h3>
<p>Default case, looking only at whole tree:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MFClusHier.html">MFClusHier</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">lung</span> <span class="op">~</span> <span class="va">tx</span> <span class="op">+</span> <span class="va">room</span> <span class="op">/</span> <span class="va">pen</span> <span class="op">/</span> <span class="va">litter</span>, data <span class="op">=</span> <span class="va">a</span><span class="op">)</span></span></code></pre></div>
<p>Selecting a single variable to evaluate for each factor:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MFClusHier.html">MFClusHier</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">lung</span> <span class="op">~</span> <span class="va">tx</span> <span class="op">+</span> <span class="va">room</span> <span class="op">/</span> <span class="va">pen</span> <span class="op">/</span> <span class="va">litter</span>, data <span class="op">=</span> <span class="va">a</span>,</span>
<span>           which.factor <span class="op">=</span> <span class="st">"room"</span><span class="op">)</span></span></code></pre></div>
<p>Selecting multiple variables, including the entire tree:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MFClusHier.html">MFClusHier</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">lung</span> <span class="op">~</span> <span class="va">tx</span> <span class="op">+</span> <span class="va">room</span> <span class="op">/</span> <span class="va">pen</span> <span class="op">/</span> <span class="va">litter</span>, data <span class="op">=</span> <span class="va">a</span>,</span>
<span>           which.factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"room"</span>, <span class="st">"litter"</span>, <span class="st">"All"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 class="unnumbered" id="basic-output-">Basic Output.<a class="anchor" aria-label="anchor" href="#basic-output-"></a>
</h3>
<p>The default display of <code>MFClusHier</code> output is a table with
one row for each unique mitigated fraction calculated. A unique
mitigated fraction value will be calculated for each level of the
variables identified by the user in the argument
<code>which.factor</code> (see previous discussion). The total number of
rows is the sum of the number of unique levels for each grouping
variable the user specified. The value “All” will add one row to this
table.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mf_multiple</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MFClusHier.html">MFClusHier</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">lung</span> <span class="op">~</span> <span class="va">tx</span> <span class="op">+</span> <span class="va">room</span> <span class="op">/</span> <span class="va">pen</span> <span class="op">/</span> <span class="va">litter</span>, data <span class="op">=</span> <span class="va">a</span>,</span>
<span>                          which.factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"room"</span>, <span class="st">"litter"</span>, <span class="st">"All"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mf_multiple</span></span></code></pre></div>
<pre><code><span><span class="co">##    variable     level   MF N1N2  U con_N vac_N con_medResp vac_medResp</span></span>
<span><span class="co">## 1      room    Room W 0.83   24 22    12    12       7.795       4.850</span></span>
<span><span class="co">## 2      room    Room Z 0.91   22 21    11    12       6.640       4.980</span></span>
<span><span class="co">## 3    litter Litter 11 1.00    4  4     2     2       8.240       5.125</span></span>
<span><span class="co">## 4    litter Litter 12 0.00    4  2     2     2       4.915       3.810</span></span>
<span><span class="co">## 5    litter Litter 13 1.00    4  4     2     2       8.105       5.230</span></span>
<span><span class="co">## 6    litter Litter 14 1.00    4  4     2     2       8.115       5.595</span></span>
<span><span class="co">## 7    litter Litter 15 1.00    4  4     2     2       8.090       5.260</span></span>
<span><span class="co">## 8    litter Litter 16 1.00    4  4     2     2       6.770       4.505</span></span>
<span><span class="co">## 9    litter Litter 17 1.00    4  4     2     2       5.575       4.260</span></span>
<span><span class="co">## 10   litter Litter 18 0.50    4  3     2     2       7.445       6.330</span></span>
<span><span class="co">## 11   litter Litter 19 1.00    4  4     2     2       7.980       4.585</span></span>
<span><span class="co">## 12   litter Litter 20 1.00    4  4     2     2       6.780       4.860</span></span>
<span><span class="co">## 13   litter Litter 21 1.00    4  4     2     2       6.820       5.365</span></span>
<span><span class="co">## 14   litter Litter 22 1.00    2  2     1     2       6.770       5.135</span></span>
<span><span class="co">## 15      All       All 0.87   46 43    23    24       7.210       4.910</span></span></code></pre>
<p>The table columns are:</p>
<ul>
<li>
<code>variable</code>: Which variable was considered when evaluating
MF for the row.</li>
<li>
<code>level</code>: A unique factor level of the variable which was
considered when evaluating MF for the row.</li>
<li>
<code>MF</code>: Mitigated fraction calculated value.</li>
<li>
<code>N1N2</code>: Sum of the <code>n1n2</code> values from the rank
table for the factor level of that row.</li>
<li>
<code>U</code>: Sum of the <code>u</code> values from the rank table
for the factor level of that row.</li>
<li>
<code>con_N</code> &amp; <code>vac_N</code>: Sum of the counts from
the rank table matching the particular factor level of the row. Note
that the left hand side of the underscore will match values passed by
user to <code>compare</code>.</li>
<li>
<code>con_medResp</code> &amp; <code>vac_medResp</code>: Median of
responses for each comparison group matching the particular factor level
of the row. Note that the left hand side of the underscore will match
values passed by user to argument <code>compare</code>.</li>
</ul>
</div>
<div class="section level3">
<h3 class="unnumbered" id="advanced-usage-">Advanced usage.<a class="anchor" aria-label="anchor" href="#advanced-usage-"></a>
</h3>
<p>This section covers the technical description of how to access the
rank table from <code><a href="../reference/MFh.html">MFh()</a></code> and summarize using
<code><a href="../reference/MFnest.html">MFnest()</a></code>. For a full discussion of the algorithms used in
these functions and how they are related, see <a href="https://github.com/ABS-dev/MF/blob/master/inst/doc/MFHierarchicalData.pdf" class="external-link">Algorithms
for calculating MF from hierarchical data</a>.</p>
<div class="section level4">
<h4 class="unnumbered" id="rank-table-">Rank table.<a class="anchor" aria-label="anchor" href="#rank-table-"></a>
</h4>
<p>To access the rank table, use the <strong>MFh</strong> field of the
output object from <code><a href="../reference/MFClusHier.html">MFClusHier()</a></code>. For example:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">thisMFh</span> <span class="op">&lt;-</span> <span class="va">mf_multiple</span><span class="op">$</span><span class="va">MFh</span></span>
<span><span class="va">thisMFh</span></span></code></pre></div>
<pre><code><span><span class="co">##      room   pen    litter con_medResp con_n w vac_medResp vac_n n1n2 u</span></span>
<span><span class="co">## 1  Room W Pen A Litter 11       8.240     2 7       5.125     2    4 4</span></span>
<span><span class="co">## 2  Room W Pen A Litter 12       4.915     2 5       3.810     2    4 2</span></span>
<span><span class="co">## 3  Room W Pen B Litter 13       8.105     2 7       5.230     2    4 4</span></span>
<span><span class="co">## 4  Room W Pen B Litter 14       8.115     2 7       5.595     2    4 4</span></span>
<span><span class="co">## 5  Room W Pen C Litter 15       8.090     2 7       5.260     2    4 4</span></span>
<span><span class="co">## 6  Room W Pen C Litter 16       6.770     2 7       4.505     2    4 4</span></span>
<span><span class="co">## 7  Room Z Pen D Litter 17       5.575     2 7       4.260     2    4 4</span></span>
<span><span class="co">## 8  Room Z Pen D Litter 18       7.445     2 6       6.330     2    4 3</span></span>
<span><span class="co">## 9  Room Z Pen E Litter 19       7.980     2 7       4.585     2    4 4</span></span>
<span><span class="co">## 10 Room Z Pen E Litter 20       6.780     2 7       4.860     2    4 4</span></span>
<span><span class="co">## 11 Room Z Pen F Litter 21       6.820     2 7       5.365     2    4 4</span></span>
<span><span class="co">## 12 Room Z Pen F Litter 22       6.770     1 3       5.135     2    2 2</span></span></code></pre>
<p>Alternatively, calculate rank table directly by using the
<code><a href="../reference/MFh.html">MFh()</a></code> function:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MFh.html">MFh</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">lung</span> <span class="op">~</span> <span class="va">tx</span> <span class="op">+</span> <span class="va">room</span> <span class="op">/</span> <span class="va">pen</span> <span class="op">/</span> <span class="va">litter</span>, data <span class="op">=</span> <span class="va">a</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##      room   pen    litter con_medResp con_n w vac_medResp vac_n n1n2 u</span></span>
<span><span class="co">## 1  Room W Pen A Litter 11       8.240     2 7       5.125     2    4 4</span></span>
<span><span class="co">## 2  Room W Pen A Litter 12       4.915     2 5       3.810     2    4 2</span></span>
<span><span class="co">## 3  Room W Pen B Litter 13       8.105     2 7       5.230     2    4 4</span></span>
<span><span class="co">## 4  Room W Pen B Litter 14       8.115     2 7       5.595     2    4 4</span></span>
<span><span class="co">## 5  Room W Pen C Litter 15       8.090     2 7       5.260     2    4 4</span></span>
<span><span class="co">## 6  Room W Pen C Litter 16       6.770     2 7       4.505     2    4 4</span></span>
<span><span class="co">## 7  Room Z Pen D Litter 17       5.575     2 7       4.260     2    4 4</span></span>
<span><span class="co">## 8  Room Z Pen D Litter 18       7.445     2 6       6.330     2    4 3</span></span>
<span><span class="co">## 9  Room Z Pen E Litter 19       7.980     2 7       4.585     2    4 4</span></span>
<span><span class="co">## 10 Room Z Pen E Litter 20       6.780     2 7       4.860     2    4 4</span></span>
<span><span class="co">## 11 Room Z Pen F Litter 21       6.820     2 7       5.365     2    4 4</span></span>
<span><span class="co">## 12 Room Z Pen F Litter 22       6.770     1 3       5.135     2    2 2</span></span></code></pre>
<p>The output table includes the following information, used to
calculate the Basic Output table as described previously:</p>
<ul>
<li>
<code>con_n</code> &amp; <code>vac_n</code>: Counts of observations
for each treatment for a particular instance of unique factor level of a
variable. Note that the left hand side of the underscore will match
values passed by user to <code>compare</code>.</li>
<li>
<code>n1n2</code>: Product of counts, <code>con_n</code> *
<code>vac_n</code>.</li>
<li>
<code>w</code>: Wilcoxon statistic.</li>
<li>
<code>u</code>: Mann-Whitney statistic.</li>
<li>
<code>con_medResp</code> &amp; <code>vac_medResp</code>: Median
observed response for each treatment group in a particular instance of
unique factor level. Note that the left hand side of the underscore will
match values passed by user to <code>compare</code>.</li>
</ul>
<p>There is one row for each unique combination of factor levels across
all variables. This table shows the initial statistics as determined by
the experimental design. Refer to the vignette for algorithm design <a href="https://github.com/ABS-dev/MF/blob/master/inst/doc/MFHierarchicalData.pdf" class="external-link">Algorithms
for calculating MF from hierarchical data</a> for in-depth discussion of
how the rank is used to evaluate mitigated fraction values.</p>
<p>The rank table is not affected by changes to the
<code>which.factor</code> argument.</p>
</div>
<div class="section level4">
<h4 class="unnumbered" id="reproducibility-">Reproducibility.<a class="anchor" aria-label="anchor" href="#reproducibility-"></a>
</h4>
<p>The rank table can be used to re-calculate the mitigated fraction
values, for example if the user intends to explore a different selection
to the <code>which.factor</code> argument. To do this, use the function
<code>MFnest</code> which takes the following input arguments:</p>
<ul>
<li>
<code>Y</code>: <strong>MFh</strong> field output as from
<code><a href="../reference/MFClusHier.html">MFClusHier()</a></code>
</li>
<li>
<code>which.factor</code>: As above.</li>
</ul>
<p>For example:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MFnest.html">MFnest</a></span><span class="op">(</span><span class="va">thisMFh</span>, which.factor <span class="op">=</span> <span class="st">"pen"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   variable level   MF N1N2 U con_N vac_N con_medResp vac_medResp</span></span>
<span><span class="co">## 1      pen Pen A 0.50    8 6     4     4       6.795       4.240</span></span>
<span><span class="co">## 2      pen Pen B 1.00    8 8     4     4       8.115       5.595</span></span>
<span><span class="co">## 3      pen Pen C 1.00    8 8     4     4       7.690       4.850</span></span>
<span><span class="co">## 4      pen Pen D 0.75    8 7     4     4       6.100       4.980</span></span>
<span><span class="co">## 5      pen Pen E 1.00    8 8     4     4       6.860       4.860</span></span>
<span><span class="co">## 6      pen Pen F 1.00    6 6     3     4       6.770       5.135</span></span></code></pre>
<p>This is the same output as if the user had initially selected for
variable “pen”:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MFClusHier.html">MFClusHier</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">lung</span> <span class="op">~</span> <span class="va">tx</span> <span class="op">+</span> <span class="va">room</span> <span class="op">/</span> <span class="va">pen</span> <span class="op">/</span> <span class="va">litter</span>, data <span class="op">=</span> <span class="va">a</span>,</span>
<span>           which.factor <span class="op">=</span> <span class="st">"pen"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   variable level   MF N1N2 U con_N vac_N con_medResp vac_medResp</span></span>
<span><span class="co">## 1      pen Pen A 0.50    8 6     4     4       6.795       4.240</span></span>
<span><span class="co">## 2      pen Pen B 1.00    8 8     4     4       8.115       5.595</span></span>
<span><span class="co">## 3      pen Pen C 1.00    8 8     4     4       7.690       4.850</span></span>
<span><span class="co">## 4      pen Pen D 0.75    8 7     4     4       6.100       4.980</span></span>
<span><span class="co">## 5      pen Pen E 1.00    8 8     4     4       6.860       4.860</span></span>
<span><span class="co">## 6      pen Pen F 1.00    6 6     3     4       6.770       5.135</span></span></code></pre>
</div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="bootstrapped-mf">BOOTSTRAPPED MF<a class="anchor" aria-label="anchor" href="#bootstrapped-mf"></a>
</h2>
<div class="section level3">
<h3 class="unnumbered" id="general-use--1">General use.<a class="anchor" aria-label="anchor" href="#general-use--1"></a>
</h3>
<p>The function <code>MFClusBootHier</code> allows for a bootstrapping
approach to calculating mitigated fraction values. Input arguments
are:</p>
<p><em>Same as in non-bootstrapped usage (i.e. MFClusHier)</em></p>
<ul>
<li>
<code>formula</code>: The formula in form <code>y ~ x + a/b/c</code>
where <code>y</code> is a continuous response, <code>x</code> is a
factor with two levels of treatment, and <code>a/b/c</code> are grouping
variables. Nesting is assumed to be in order, left to right, highest to
lowest. So a single level of “a” will contain multiple levels of “b” and
a single level of “b” will contain multiple levels of “c”.</li>
<li>
<code>data</code>: The data table (<code>data.frame</code> or
<code>tibble</code>) with variables as identified in argument
<code>formula</code>. If there are extra variables, they will be
ignored.</li>
<li>
<code>compare</code>: Treatment groups, a text vector of length two.
The first position [1] is treated as the control or reference group to
which members of the second position [2] are compared.</li>
<li>
<code>which.factor</code>: Variable(s) of interest. This can be any
of the grouping variables from the data set. If “All” is specified, a
summary MF will be calculated for the whole tree.</li>
</ul>
<p><em>Additional arguments</em></p>
<ul>
<li>
<code>nboot</code>: Number of bootstrapping events.</li>
<li>
<code>boot.unit</code>: Boolean whether to sample observations from
within those of the same core.</li>
<li>
<code>boot.cluster</code>: Boolean whether to sample which clusters
are present. If TRUE, some trees have all the clusters represented in
the original data while others only have a subset.</li>
<li>
<code>alpha</code>: Complement of the confidence level. As used in
<code>MFClusBoot</code>.</li>
<li>
<code>seed</code>: Used to initialize random number generator for
reproducibility.</li>
</ul>
<p>A “core” is the unique combination of variable levels from the data,
including the <code>compare</code> designation. In Table 1, one core
would be Room W/Pen A/Litter 11/vac and another would be Room Z/Pen
F/Litter 22/con.</p>
<p>A “cluster” is the the unique combination of variable levels from the
data, without the <code>compare</code> designation. In Table 1, the
first four observations are from the same core, Room W/Pen A/Litter
11.</p>
<p>Refer to the <code>MFClusHier</code> help page
(<code><a href="../reference/MFClusBootHier.html">?MFClusBootHier</a></code>) for extended usage details.</p>
<p>Further discussion regarding the bootstrapping algorithm can be found
in <a href="https://github.com/ABS-dev/MF/blob/master/inst/doc/MFHierarchicalData.pdf" class="external-link">Algorithms
for calculating MF from hierarchical data</a>.</p>
</div>
<div class="section level3">
<h3 class="unnumbered" id="common-coding-examples--1">Common coding examples.<a class="anchor" aria-label="anchor" href="#common-coding-examples--1"></a>
</h3>
<p>Default case, looking only at whole tree and bootstrapping both at
the cluster and unit levels:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MFClusBootHier.html">MFClusBootHier</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">lung</span> <span class="op">~</span> <span class="va">tx</span> <span class="op">+</span> <span class="va">room</span> <span class="op">/</span> <span class="va">pen</span> <span class="op">/</span> <span class="va">litter</span>,</span>
<span>               data <span class="op">=</span> <span class="va">a</span><span class="op">)</span></span></code></pre></div>
<p>Specifying what bootstrapping sampling to occur:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MFClusBootHier.html">MFClusBootHier</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">lung</span> <span class="op">~</span> <span class="va">tx</span> <span class="op">+</span> <span class="va">room</span> <span class="op">/</span> <span class="va">pen</span> <span class="op">/</span> <span class="va">litter</span>,</span>
<span>               data <span class="op">=</span> <span class="va">a</span>, boot.unit <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               boot.cluster <span class="op">=</span> <span class="cn">FALSE</span>, which.factor <span class="op">=</span> <span class="st">"room"</span><span class="op">)</span></span></code></pre></div>
<p>Adjusting the number of bootstrapping events and alpha:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MFClusBootHier.html">MFClusBootHier</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">lung</span> <span class="op">~</span> <span class="va">tx</span> <span class="op">+</span> <span class="va">room</span> <span class="op">/</span> <span class="va">pen</span> <span class="op">/</span> <span class="va">litter</span>,</span>
<span>               data <span class="op">=</span> <span class="va">a</span>, boot.unit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>               boot.cluster <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>               which.factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"room"</span>, <span class="st">"litter"</span>, <span class="st">"All"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 class="unnumbered" id="basic-output--1">Basic output.<a class="anchor" aria-label="anchor" href="#basic-output--1"></a>
</h3>
<p>The default display of <code>MFClusBootHier</code> is a table with
one row for each unique mitigated fraction calculated, just like in the
non-bootstrapped approach. However, instead of summary statistics about
the calculated mitigated fraction, there are values summarizing the
mitigated fraction from a bootstrapped population.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mfboot_multiple</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MFClusBootHier.html">MFClusBootHier</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">lung</span> <span class="op">~</span> <span class="va">tx</span> <span class="op">+</span> <span class="va">room</span> <span class="op">/</span> <span class="va">pen</span> <span class="op">/</span> <span class="va">litter</span>,</span>
<span>                                  data <span class="op">=</span> <span class="va">a</span>, boot.unit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                                  boot.cluster <span class="op">=</span> <span class="cn">TRUE</span>, alpha <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>                                  which.factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"room"</span>, <span class="st">"litter"</span>, <span class="st">"All"</span><span class="op">)</span>,</span>
<span>                                  seed <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span>
<span><span class="va">mfboot_multiple</span></span></code></pre></div>
<pre><code><span><span class="co">##    variable     level median etlower etupper hdlower hdupper mf.obs</span></span>
<span><span class="co">## 1      room    Room W   0.83    0.50     1.0    0.60     1.0   0.83</span></span>
<span><span class="co">## 2      room    Room Z   0.92    0.75     1.0    0.80     1.0   0.91</span></span>
<span><span class="co">## 3    litter Litter 11   1.00    1.00     1.0    1.00     1.0   1.00</span></span>
<span><span class="co">## 4    litter Litter 12   0.00    0.00     0.0    0.00     0.0   0.00</span></span>
<span><span class="co">## 5    litter Litter 13   1.00    1.00     1.0    1.00     1.0   1.00</span></span>
<span><span class="co">## 6    litter Litter 14   1.00    1.00     1.0    1.00     1.0   1.00</span></span>
<span><span class="co">## 7    litter Litter 15   1.00    1.00     1.0    1.00     1.0   1.00</span></span>
<span><span class="co">## 8    litter Litter 16   1.00    1.00     1.0    1.00     1.0   1.00</span></span>
<span><span class="co">## 9    litter Litter 17   1.00    1.00     1.0    1.00     1.0   1.00</span></span>
<span><span class="co">## 10   litter Litter 18   0.50    0.50     0.5    0.50     0.5   0.50</span></span>
<span><span class="co">## 11   litter Litter 19   1.00    1.00     1.0    1.00     1.0   1.00</span></span>
<span><span class="co">## 12   litter Litter 20   1.00    1.00     1.0    1.00     1.0   1.00</span></span>
<span><span class="co">## 13   litter Litter 21   1.00    1.00     1.0    1.00     1.0   1.00</span></span>
<span><span class="co">## 14   litter Litter 22   1.00    1.00     1.0    1.00     1.0   1.00</span></span>
<span><span class="co">## 15      All       All   0.88    0.71     1.0    0.75     1.0   0.87</span></span></code></pre>
<p>The variable columns are:</p>
<ul>
<li>
<code>variable</code>: Which variable was considered when evaluating
MF for the row.</li>
<li>
<code>level</code>: A unique factor level of the variable which was
considered when evaluating MF for the row.</li>
<li>
<code>median</code>: Median of mitigated fractions calculated from
the bootstrapped population.</li>
<li>
<code>etlower</code>: Lower value of equal tailed range of mitigated
fractions calculated from the bootstrapped population.</li>
<li>
<code>etupper</code>: Upper value of equal tailed range of mitigated
fractions calculated from the bootstrapped population.</li>
<li>
<code>hdlower</code>: Lower value of the highest posterior density
range of mitigated fractions calculated from the bootstrapped
population.</li>
<li>
<code>hdupper</code>: Upper value of the highest posterior density
range of mitigated fractions calculated from the bootstrapped
population.</li>
<li>
<code>mf.obs</code>: Mitigated fraction value calculated from data
input, without bootstrapping.</li>
</ul>
</div>
<div class="section level3">
<h3 class="unnumbered" id="advanced-usage--1">Advanced usage.<a class="anchor" aria-label="anchor" href="#advanced-usage--1"></a>
</h3>
<p>This section covers the technical description of how to access the
bootstrapped results and use the <code><a href="../reference/MFnestBoot.html">MFnestBoot()</a></code> function. For
a full discussion of the algorithms of how <code><a href="../reference/MFhBoot.html">MFhBoot()</a></code>,
<code><a href="../reference/MFnestBoot.html">MFnestBoot()</a></code> and <code>MFClusBootHier</code> are related,
or details of the bootstrapping algorithm, see <a href="https://github.com/ABS-dev/MF/blob/master/inst/doc/MF-manual.pdf" class="external-link">Algorithms
for calculating MF from hierarchical data</a>.</p>
<div class="section level4">
<h4 class="unnumbered" id="bootstrapping-step-output-">Bootstrapping step output.<a class="anchor" aria-label="anchor" href="#bootstrapping-step-output-"></a>
</h4>
<p>The bootstrapping stage is the most computationally intensive, so a
user may wish to bypass this step subsequently if the only change are
values being passed to the <code>which.factor</code> or
<code>alpha</code> arguments. Access bootstrapping step outputs using
the <strong>MFhBoot</strong> field of the output object. For
example:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">this_boot_mfh</span> <span class="op">&lt;-</span> <span class="va">mfboot_multiple</span><span class="op">$</span><span class="va">MFhBoot</span></span>
<span><span class="va">this_boot_mfh</span></span></code></pre></div>
<pre><code><span><span class="co">## $bootmfh</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 120,000 × 11</span></span></span>
<span><span class="co">##    bootID con_medResp con_n     w vac_medResp vac_n     u  n1n2 room   pen  </span></span>
<span><span class="co">##     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>      1        8.24     2     7        5.12     2     4     4 Room W Pen A</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>      1        8.10     2     7        5.23     2     4     4 Room W Pen B</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>      1        8.10     2     7        5.23     2     4     4 Room W Pen B</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>      1        8.10     2     7        5.23     2     4     4 Room W Pen B</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>      1        8.12     2     7        5.60     2     4     4 Room W Pen B</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>      1        8.12     2     7        5.60     2     4     4 Room W Pen B</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>      1        8.09     2     7        5.26     2     4     4 Room W Pen C</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>      1        8.09     2     7        5.26     2     4     4 Room W Pen C</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>      1        8.09     2     7        5.26     2     4     4 Room W Pen C</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>      1        5.57     2     7        4.26     2     4     4 Room Z Pen D</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 119,990 more rows</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: litter &lt;chr&gt;</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $clusters</span></span>
<span><span class="co">##      room   pen    litter clusterID</span></span>
<span><span class="co">## 1  Room W Pen A Litter 11         1</span></span>
<span><span class="co">## 2  Room W Pen A Litter 12         2</span></span>
<span><span class="co">## 3  Room W Pen B Litter 13         3</span></span>
<span><span class="co">## 4  Room W Pen B Litter 14         4</span></span>
<span><span class="co">## 5  Room W Pen C Litter 15         5</span></span>
<span><span class="co">## 6  Room W Pen C Litter 16         6</span></span>
<span><span class="co">## 7  Room Z Pen D Litter 17         7</span></span>
<span><span class="co">## 8  Room Z Pen D Litter 18         8</span></span>
<span><span class="co">## 9  Room Z Pen E Litter 19         9</span></span>
<span><span class="co">## 10 Room Z Pen E Litter 20        10</span></span>
<span><span class="co">## 11 Room Z Pen F Litter 21        11</span></span>
<span><span class="co">## 12 Room Z Pen F Litter 22        12</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $compare</span></span>
<span><span class="co">## [1] "con" "vac"</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $mfh</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 12 × 10</span></span></span>
<span><span class="co">##    room   pen   litter    con_medResp con_n     w vac_medResp vac_n  n1n2     u</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> Room W Pen A Litter 11        8.24     2     7        5.12     2     4     4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> Room W Pen A Litter 12        4.92     2     5        3.81     2     4     2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> Room W Pen B Litter 13        8.10     2     7        5.23     2     4     4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> Room W Pen B Litter 14        8.12     2     7        5.60     2     4     4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> Room W Pen C Litter 15        8.09     2     7        5.26     2     4     4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> Room W Pen C Litter 16        6.77     2     7        4.50     2     4     4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> Room Z Pen D Litter 17        5.57     2     7        4.26     2     4     4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> Room Z Pen D Litter 18        7.44     2     6        6.33     2     4     3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> Room Z Pen E Litter 19        7.98     2     7        4.58     2     4     4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> Room Z Pen E Litter 20        6.78     2     7        4.86     2     4     4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span> Room Z Pen F Litter 21        6.82     2     7        5.36     2     4     4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span> Room Z Pen F Litter 22        6.77     1     3        5.14     2     2     2</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $seed</span></span>
<span><span class="co">## [1] 150</span></span></code></pre>
<p>It is possible to calculate <code>mfboot_multiple$MFhBoot</code>
directly by using the <code><a href="../reference/MFhBoot.html">MFhBoot()</a></code> function, however this
executes the bootstrapping stage again. To get the same output with both
approaches, the <code>seed</code> argument must be the same value.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MFhBoot.html">MFhBoot</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">lung</span> <span class="op">~</span> <span class="va">tx</span> <span class="op">+</span> <span class="va">room</span> <span class="op">/</span> <span class="va">pen</span> <span class="op">/</span> <span class="va">litter</span>,</span>
<span>        data <span class="op">=</span> <span class="va">a</span>, boot.unit <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        boot.cluster <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>        seed <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span></code></pre></div>
<p>This output is a list of four objects:</p>
<ul>
<li>
<code>bootmfh</code>: The rank table of all the bootstrapped data
sets. This is formatted as the rank table for non-bootstrapped data with
designation of a single bootstrapping instance using the additional
variable <strong>bootID</strong>. Values for <strong>bootID</strong> are
simply <code>1:nboot</code>.</li>
<li>
<code>clusters</code>: Unique clusters in the data.</li>
<li>
<code>compare</code>: User-supplied value passed to compare
argument.</li>
<li>
<code>mfh</code>: The rank table from user-supplied data; formatted
as for non-bootstrapped data.</li>
</ul>
<p>Note that in the particular case of
<code>boot.cluster = FALSE</code>, although all <code>nboot</code>
instances will be the same clusters as input data, observed responses
will vary due to sampling of the cores. The case of both
<code>boot.cluster</code> and <code>boot.unit</code> as FALSE is simply
calculating MF from data without any bootstrapping.</p>
</div>
<div class="section level4">
<h4 class="unnumbered" id="reproducibility--1">Reproducibility.<a class="anchor" aria-label="anchor" href="#reproducibility--1"></a>
</h4>
<p>To bootstrap from the same data in a reproducible manner, numerical
value for the <strong>seed</strong> argument in
<code>MFClusBootHier</code>. If no value for <code>seed</code> is
specified, the function defaults to a value of
<code>sample(1:1e+05, 1)</code> and subsequent iterations may yield
different summaries.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MFClusBootHier.html">MFClusBootHier</a></span><span class="op">(</span>formula <span class="op">=</span> <span class="va">lung</span> <span class="op">~</span> <span class="va">tx</span> <span class="op">+</span> <span class="va">room</span> <span class="op">/</span> <span class="va">pen</span> <span class="op">/</span> <span class="va">litter</span>,</span>
<span>               data <span class="op">=</span> <span class="va">a</span>, seed <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span></code></pre></div>
<p>Since the bootstrapping step is the most computationally intensive, a
user may wish to use the bootstrapped rank table to recalculate
mitigated fraction for levels of different variables or a different
<code>alpha</code> for calculating confidence intervals. This is
possible using the <code>MFnestBoot</code> function, which takes the
following input arguments:</p>
<ul>
<li>
<code>x</code>: <strong>MFhBoot</strong> field output as from
<code>MFClusBootHier</code>.</li>
<li>
<code>which.factor</code>: As above.</li>
<li>
<code>alpha</code>: As above.</li>
</ul>
<p>For example:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/MFnestBoot.html">MFnestBoot</a></span><span class="op">(</span><span class="va">this_boot_mfh</span>, which.factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pen"</span>, <span class="st">"All"</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Complete separation observed for variable(s): pen</span></span></code></pre>
<pre><code><span><span class="co">## $mfnest_details</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 63,224 × 8</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Groups:   variable, level [7]</span></span></span>
<span><span class="co">##    variable level bootID     U  N1N2 con_N vac_N    MF</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> All      All        1    47    48    24    24 0.958</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> All      All        2    44    48    24    24 0.833</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> All      All        3    39    46    23    24 0.696</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> All      All        4    43    46    23    24 0.870</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> All      All        5    37    40    20    24 0.85 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> All      All        6    45    46    23    24 0.957</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> All      All        7    46    48    24    24 0.917</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> All      All        8    39    44    22    24 0.773</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> All      All        9    48    48    24    24 1    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> All      All       10    41    44    22    24 0.864</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 63,214 more rows</span></span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $mfnest_summary</span></span>
<span><span class="co">## <span style="color: #949494;"># A tibble: 7 × 8</span></span></span>
<span><span class="co">##   variable level median etlower etupper hdlower hdupper mf.obs</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> pen      Pen A  0.5     0           1    0          1  0.5  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> pen      Pen B  1       1           1    1          1  1    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> pen      Pen C  1       1           1    1          1  1    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> pen      Pen D  0.75    0.5         1    0.5        1  0.75 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> pen      Pen E  1       1           1    1          1  1    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> pen      Pen F  1       1           1    1          1  1    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span> All      All    0.875   0.708       1    0.75       1  0.870</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $seed</span></span>
<span><span class="co">## [1] 150</span></span></code></pre>
</div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="appendix">APPENDIX<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<div class="section level3">
<h3 class="unnumbered" id="code-for-example-data-">Code for example data.<a class="anchor" aria-label="anchor" href="#code-for-example-data-"></a>
</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  room <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Room"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"W"</span>, <span class="st">"Z"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">24</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  pen <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Pen"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, each <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  litter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Litter"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">11</span><span class="op">:</span><span class="fl">22</span>, each <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  tx <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"vac"</span>, <span class="st">"con"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="fl">12</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">76153</span><span class="op">)</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="va">lung</span><span class="op">[</span><span class="va">a</span><span class="op">$</span><span class="va">tx</span> <span class="op">==</span> <span class="st">"vac"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">24</span>, <span class="fl">5</span>, <span class="fl">1.3</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="va">lung</span><span class="op">[</span><span class="va">a</span><span class="op">$</span><span class="va">tx</span> <span class="op">==</span> <span class="st">"con"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">24</span>, <span class="fl">7</span>, <span class="fl">1.3</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[</span><span class="op">-</span><span class="fl">48</span>, <span class="op">]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 class="unnumbered" id="session-details-for-this-manual-">Session details for this manual.<a class="anchor" aria-label="anchor" href="#session-details-for-this-manual-"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.5.0 (2025-04-11 ucrt)</span></span>
<span><span class="co">## Platform: x86_64-w64-mingw32/x64</span></span>
<span><span class="co">## Running under: Windows 11 x64 (build 22631)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">##   LAPACK version 3.12.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">## [1] LC_COLLATE=English_United States.utf8 </span></span>
<span><span class="co">## [2] LC_CTYPE=English_United States.utf8   </span></span>
<span><span class="co">## [3] LC_MONETARY=English_United States.utf8</span></span>
<span><span class="co">## [4] LC_NUMERIC=C                          </span></span>
<span><span class="co">## [5] LC_TIME=English_United States.utf8    </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: America/Chicago</span></span>
<span><span class="co">## tzcode source: internal</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">##  [1] MF_4.4.11        lubridate_1.9.4  forcats_1.0.0    stringr_1.5.1   </span></span>
<span><span class="co">##  [5] dplyr_1.1.4      purrr_1.0.4      readr_2.1.5      tidyr_1.3.1     </span></span>
<span><span class="co">##  [9] tibble_3.3.0     ggplot2_3.5.2    tidyverse_2.0.0  kableExtra_1.4.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] utf8_1.2.6         sass_0.4.10        generics_0.1.4     xml2_1.3.8        </span></span>
<span><span class="co">##  [5] stringi_1.8.7      hms_1.1.3          digest_0.6.37      magrittr_2.0.3    </span></span>
<span><span class="co">##  [9] timechange_0.3.0   evaluate_1.0.4     grid_4.5.0         RColorBrewer_1.1-3</span></span>
<span><span class="co">## [13] fastmap_1.2.0      plyr_1.8.9         jsonlite_2.0.0     viridisLite_0.4.2 </span></span>
<span><span class="co">## [17] scales_1.4.0       textshaping_1.0.1  jquerylib_0.1.4    cli_3.6.5         </span></span>
<span><span class="co">## [21] rlang_1.1.6        withr_3.0.2        cachem_1.1.0       yaml_2.3.10       </span></span>
<span><span class="co">## [25] tools_4.5.0        tzdb_0.5.0         vctrs_0.6.5        R6_2.6.1          </span></span>
<span><span class="co">## [29] lifecycle_1.0.4    fs_1.6.6           htmlwidgets_1.6.4  ragg_1.4.0        </span></span>
<span><span class="co">## [33] pkgconfig_2.0.3    desc_1.4.3         pkgdown_2.1.3      pillar_1.10.2     </span></span>
<span><span class="co">## [37] bslib_0.9.0        gtable_0.3.6       Rcpp_1.1.0         glue_1.8.0        </span></span>
<span><span class="co">## [41] systemfonts_1.2.3  xfun_0.52          tidyselect_1.2.1   rstudioapi_0.17.1 </span></span>
<span><span class="co">## [45] knitr_1.50         dichromat_2.0-0.1  farver_2.1.2       htmltools_0.5.8.1 </span></span>
<span><span class="co">## [49] rmarkdown_2.29     svglite_2.2.1      compiler_4.5.0</span></span></code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by CVB Statistics, David Siev, Marie Vendettuoli, Thomas Kent.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
