<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bootstrap CI for MF, HL, and Qdif — HLBoot • MF</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bootstrap CI for MF, HL, and Qdif — HLBoot"><meta name="description" content="Estimates bootstrap confidence intervals for MF, HL, and Qdif."><meta property="og:description" content="Estimates bootstrap confidence intervals for MF, HL, and Qdif."><meta property="og:image" content="https://abs-dev.github.io/MF/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MF</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.4.11</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/QuickStartHierData.html">Quick Start when calculating MF from Hierarchical Data</a></li>
    <li><a class="dropdown-item" href="../articles/MFHierarchicalData.html">Algorithms for calculating MF from hierarchical data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ABS-dev/MF" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Bootstrap CI for MF, HL, and Qdif</h1>

      <div class="d-none name"><code>HLBoot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimates bootstrap confidence intervals for MF, HL, and Qdif.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">HLBoot</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  compare <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"con"</span>, <span class="st">"vac"</span><span class="op">)</span>,</span>
<span>  b <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  B <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  hpd <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  bca <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return.boot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  trace.it <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  seed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">1e+05</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>Formula of the form <code>y ~ x + cluster(w)</code>, where y is a
continuous response, x is a factor with two levels of treatment, and w is a
factor indicating the clusters.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>Data frame</p></dd>


<dt id="arg-compare">compare<a class="anchor" aria-label="anchor" href="#arg-compare"></a></dt>
<dd><p>Text vector stating the factor levels - <code>compare[1]</code> is the
control or reference group to which <code>compare[2]</code> is compared</p></dd>


<dt id="arg-b">b<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>Number of bootstrap samples to take with each cycle</p></dd>


<dt id="arg-b">B<a class="anchor" aria-label="anchor" href="#arg-b"></a></dt>
<dd><p>Number of cycles, giving the total number of samples = B * b</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Complement of the confidence level</p></dd>


<dt id="arg-hpd">hpd<a class="anchor" aria-label="anchor" href="#arg-hpd"></a></dt>
<dd><p>Boolean whether to estimate highest density intervals for MF and
HL.</p></dd>


<dt id="arg-bca">bca<a class="anchor" aria-label="anchor" href="#arg-bca"></a></dt>
<dd><p>Boolean whether to estimate BCa intervals for MF.</p></dd>


<dt id="arg-return-boot">return.boot<a class="anchor" aria-label="anchor" href="#arg-return-boot"></a></dt>
<dd><p>Boolean whether to save the bootstrap samples of the
statistics.</p></dd>


<dt id="arg-trace-it">trace.it<a class="anchor" aria-label="anchor" href="#arg-trace-it"></a></dt>
<dd><p>Boolean whether to display verbose tracking of the cycles.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>to initialize random number generator for reproducibility. Passed
to <code>set.seed</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a <a href="mfhlboot-class.html">mfhlboot</a> data object</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Estimates bootstrap confidence intervals for the mitigated fraction
(MF), Hodge-Lehmann estimator (HL), and the difference of medians and
quartiles (Qdif). Equal tailed intervals are provided for all three,
highest density intervals are optionally provided for MF and HL, and BCa
intervals are optionally provided for MF.  The Hodges-Lehmann estimator is
the median difference; it assumes that the two distributions have the same
shape and differ by a constant shift. Assumes data is single pool (no
nesting).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hodges JL, Lehmann EL, (1963). Estimates of location based on
rank tests. <em>Annals of Mathematical Statistics.</em> <strong>34:598–611</strong>.</p>
<p>Siev D, (2005). An estimator of intervention effect on disease severity.
<em>Journal of Modern Applied Statistical Methods.</em>
<strong>4:500–508</strong>.</p>
<p>Efron B, Tibshirani RJ. <em>An Introduction to the Bootstrap.</em> Chapman and
Hall, New York, 1993.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="mfhlboot-class.html">mfhlboot</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><a href="MF-package.html">MF-package</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">HLBoot</span><span class="op">(</span><span class="va">lesion</span> <span class="op">~</span> <span class="va">group</span>, <span class="va">calflung</span>, seed <span class="op">=</span> <span class="fl">12345</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Bootstrapping</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10000 bootstrap samples</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95% confidence intervals</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comparing vac to con </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Seed =  12345</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mitigated Fraction</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 observed median  lower  upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Equal Tailed        0.44 0.4464 0.1328 0.7120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Highest Density     0.44 0.4464 0.1456 0.7184</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Hodges-Lehmann</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 observed   median    lower    upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Equal Tailed    -0.07335 -0.07335 -0.17375 -0.01445</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Highest Density -0.07335 -0.07335 -0.16330 -0.01077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Quartile Differences (quartiles of vac - quartiles of con)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      observed    median   lower     upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q25 -0.041500 -0.041300 -0.1034 -0.000905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q50 -0.112525 -0.111175 -0.2819  0.023200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q75 -0.168000 -0.170425 -0.3889  0.030000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Quartiles of con </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     observed   median   lower   upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q25 0.054000 0.054000 0.01525 0.11275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q50 0.139275 0.139275 0.06140 0.31000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q75 0.315000 0.315000 0.17300 0.45250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Quartiles of vac </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     observed  median   lower    upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q25  0.01250 0.01250 0.00125 0.026000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q50  0.02675 0.02675 0.01665 0.144575</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q75  0.14700 0.14700 0.02810 0.219250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Bootstrapping</span></span></span>
<span class="r-in"><span><span class="co"># . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</span></span></span>
<span class="r-in"><span><span class="co"># . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .</span></span></span>
<span class="r-in"><span><span class="co"># . . . . . . . . . . . . . . . . . . . . . . . .</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># 10000 bootstrap samples</span></span></span>
<span class="r-in"><span><span class="co"># 95% confidence intervals</span></span></span>
<span class="r-in"><span><span class="co"># Comparing vac to con</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># Mitigated Fraction</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># observed median lower  upper</span></span></span>
<span class="r-in"><span><span class="co"># Equal Tailed        0.44 0.4496 0.152 0.7088</span></span></span>
<span class="r-in"><span><span class="co"># Highest Density     0.44 0.4496 0.152 0.7088</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># Hodges-Lehmann</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># observed   median    lower       upper</span></span></span>
<span class="r-in"><span><span class="co"># Equal Tailed    -0.07335 -0.07615 -0.17220 -0.01565000</span></span></span>
<span class="r-in"><span><span class="co"># Highest Density -0.07335 -0.07615 -0.15635 -0.00850065</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># Quartile Differences (quartiles of vac - quartiles of con)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># observed    median    lower     upper</span></span></span>
<span class="r-in"><span><span class="co"># Q25 -0.041500 -0.041500 -0.10340 -0.000905</span></span></span>
<span class="r-in"><span><span class="co"># Q50 -0.112525 -0.111175 -0.28115  0.019350</span></span></span>
<span class="r-in"><span><span class="co"># Q75 -0.168000 -0.170425 -0.38890  0.005300</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># Quartiles of con</span></span></span>
<span class="r-in"><span><span class="co"># observed   median    lower   upper</span></span></span>
<span class="r-in"><span><span class="co"># Q25 0.054000 0.054000 0.021005 0.11275</span></span></span>
<span class="r-in"><span><span class="co"># Q50 0.139275 0.139275 0.061400 0.31000</span></span></span>
<span class="r-in"><span><span class="co"># Q75 0.315000 0.315000 0.173000 0.44625</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># Quartiles of vac</span></span></span>
<span class="r-in"><span><span class="co"># observed  median   lower    upper</span></span></span>
<span class="r-in"><span><span class="co"># Q25  0.01250 0.01250 0.00125 0.026000</span></span></span>
<span class="r-in"><span><span class="co"># Q50  0.02675 0.02675 0.01665 0.144575</span></span></span>
<span class="r-in"><span><span class="co"># Q75  0.14700 0.14700 0.02810 0.219250</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by CVB Statistics, David Siev, Marie Vendettuoli, Thomas Kent.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

